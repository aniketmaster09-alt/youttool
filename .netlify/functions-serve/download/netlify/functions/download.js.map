{
  "version": 3,
  "sources": ["../../../../Downloads/youtube-downloader/netlify/functions/download.js"],
  "sourceRoot": "C:/Users/ADMIN/AppData/Local/Temp/tmp-10276-ea3MdK65qOYn",
  "sourcesContent": ["const { exec } = require('child_process');\nconst { promisify } = require('util');\nconst execAsync = promisify(exec);\n\nexports.handler = async (event, context) => {\n    const headers = {\n        'Access-Control-Allow-Origin': '*',\n        'Access-Control-Allow-Headers': 'Content-Type',\n        'Access-Control-Allow-Methods': 'POST, OPTIONS'\n    };\n\n    if (event.httpMethod === 'OPTIONS') {\n        return { statusCode: 200, headers, body: '' };\n    }\n\n    if (event.httpMethod !== 'POST') {\n        return {\n            statusCode: 405,\n            headers,\n            body: JSON.stringify({ error: 'Method not allowed' })\n        };\n    }\n\n    try {\n        const { url } = JSON.parse(event.body);\n        \n        if (!url || (!url.includes('youtube.com') && !url.includes('youtu.be'))) {\n            return {\n                statusCode: 400,\n                headers,\n                body: JSON.stringify({ error: 'Invalid YouTube URL' })\n            };\n        }\n\n        const { stdout } = await execAsync(`yt-dlp -J \"${url}\"`);\n        const info = JSON.parse(stdout);\n        const medias = [];\n\n        // Process all formats\n        info.formats.forEach(format => {\n            if (format.url) {\n                const isVideo = format.vcodec && format.vcodec !== 'none';\n                const isAudio = format.acodec && format.acodec !== 'none';\n                \n                const media = {\n                    formatId: parseInt(format.format_id),\n                    label: `${format.ext} (${format.height ? format.height + 'p' : format.abr ? format.abr + 'kb/s' : 'audio'})`,\n                    type: isVideo ? 'video' : 'audio',\n                    ext: format.ext,\n                    quality: `${format.ext} (${format.height ? format.height + 'p' : format.abr ? format.abr + 'kb/s' : 'audio'})`,\n                    width: format.width || null,\n                    height: format.height || null,\n                    url: format.url,\n                    bitrate: format.tbr ? Math.round(format.tbr * 1000) : format.abr ? Math.round(format.abr * 1000) : null,\n                    fps: format.fps || null,\n                    audioQuality: isAudio ? (format.abr > 100 ? 'AUDIO_QUALITY_MEDIUM' : 'AUDIO_QUALITY_LOW') : null,\n                    audioSampleRate: format.asr ? format.asr.toString() : null,\n                    mimeType: `${isVideo ? 'video' : 'audio'}/${format.ext}${format.vcodec ? `; codecs=\"${format.vcodec}${isAudio ? ', ' + format.acodec : ''}\"` : ''}`,\n                    duration: Math.round(info.duration),\n                    is_audio: isAudio,\n                    extension: format.ext\n                };\n                medias.push(media);\n            }\n        });\n\n        const response = {\n            url: url,\n            source: 'youtube',\n            title: info.title,\n            author: info.uploader || '',\n            thumbnail: info.thumbnail,\n            duration: Math.round(info.duration),\n            medias: medias,\n            type: 'multiple',\n            error: false,\n            time_end: Date.now() % 1000\n        };\n\n        return {\n            statusCode: 200,\n            headers,\n            body: JSON.stringify(response)\n        };\n        \n    } catch (error) {\n        return {\n            statusCode: 500,\n            headers,\n            body: JSON.stringify({ \n                error: true,\n                message: error.message \n            })\n        };\n    }\n};"],
  "mappings": "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",
  "names": []
}
